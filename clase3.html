<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Clase 3</title>

    <link rel="stylesheet" href="dist/reset.css">
    <link rel="stylesheet" href="dist/reveal.css">
    <link rel="stylesheet" href="common.css">
    <!-- Solarized theme -->
    <link id="light-theme" rel="stylesheet" href="dist/theme/solarized.css">
    <!-- Moon theme -->
    <link id="dark-theme" rel="stylesheet" href="dist/theme/moon.css" disabled>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css"
        integrity="sha384-X38yfunGUhNzHpBaEBsWLO+A0HDYOQi8ufWDkZ0k9e0eXz/tH3II7uKZ9msv++Ls" crossorigin="anonymous">

    <link rel="stylesheet" href="plugin/highlight/atom-one-dark.css">
    <style>
        table:not(code table),
        th:not(code th),
        td:not(code td) {
            border: 1px solid black;
            border-collapse: collapse;
        }
    </style>
    <!-- Favicon Links -->
    <link rel="icon" type="image/png" sizes="16x16" href="media/favicon/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="media/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="media/favicon/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="media/favicon/android-chrome-512x512.png">
    <link rel="apple-touch-icon" sizes="180x180" href="media/favicon/apple-touch-icon.png">
</head>

<body data-theme="light">
    <a href="index.html" class="back-link">Volver</a>

    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
        <svg class="icon sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
        <svg class="icon moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>
    </button>
    <div class="reveal">
        <div class="slides">
            <!-- Each section corresponds to a slide -->
            <section>
                <h1>3. Nivel básico-intermedio de Python</h1>
            </section>
            <section>
                <h2>Hoy veremos</h2>
                <ul
                    style="list-style-type: none; padding: 0; display: grid; grid-template-columns: repeat(3, 1fr); gap: 1px;">
                    <li class="fragment" style="text-align: center;">
                        <p>1. Input - Output (I/O)</p>
                        <img src="media/3/input_output.png" alt="Input-output" style="max-width: 550px; height: auto;">
                    </li>
                    <li class="fragment" style="text-align: center;">
                        <p>2. Lambdas</p>
                        <img src="media/3/lambdas.png" alt="Lambda syntax" style="max-width: 550px; height: auto;">
                    </li>
                    <li class="fragment" style="text-align: center;">
                        <p>3. Programación orientada a objetos</p>
                        <img src="media/3/oop.svg" alt="OOP" style="max-width: 550px; height: auto;">
                    </li>
                </ul>
            </section>

            <section>
                <h2>I/O</h2>
                <p>Sabemos cómo imprimir datos por consola:</p>
                <pre><code data-line-numbers="2-10" class="python">
x = 4
print(f"2+2 = {x}")

print("Damn")
print("LaTeX no soportado por defecto: " + "$x^2 = 2$")
print("123", "456", "789", sep="-")

print("Hola", end=" ")
print("mundo!")

                    </code></pre>

                <p class="fragment" style="margin-top:2rem;">Veamos el proceso inverso: la introducción de datos por
                    consola.</p>
            </section>

            <section>
                <h3>I/O</h3>
                <div style="display: flex; flex-direction: row; gap: 1rem;">
                    <div style="flex: 2; display: flex; flex-direction: column; gap: 2rem;">
                        <div style="flex: 2; text-align: left;">
                            <p>Podemos pedir al usuario que introduzca datos usando <span
                                    class="monospace">input("mensaje")</span></p>
                            <pre><code data-line-numbers="2-6" class="python">
    username = input("Dime tu nombre: ")
    print(username)
    
                        </code></pre>

                        </div>

                        <div style="flex: 3; text-align: left;" class="fragment">
                            <p>Si el prompt es largo, es recomendable escribirlo por separado de antemano:</p>
                            <pre><code data-line-numbers="2-6" class="python">
    prompt = "Buenos días! Este es el servicio de atención al usuario.\n"
    prompt += "Por favor, escribe tu nombre: "

    nombre = input(prompt)
    print(f"Hola, {nombre}.")

                        </code></pre>
                        </div>
                    </div>
                    <div style="flex:1;" class="fragment">
                        <img src="media/3/meme_input.webp">
                    </div>
                </div>
                <aside class="notes">
                    "Dime tu nombre: " es la prompt
                    Lo que el usuario introduce se guarda en la variable mensaje_del_usuario
                    Es recomendable dejar un espacio después de : para mejor legibilidad
                </aside>
            </section>

            <section>
                <h3>I/O</h3>
                <p>Por defecto, <span class="monospace">input()</span> devuelve strings.</p>
                <pre><code data-line-numbers="2-6" class="python">
    edad = input("¿Cuántos años tienes? ")
    if edad >= 18:       # TypeError: '>=' not supported between instances of 'str' and 'int'
        print("Adulto")
    else:
        print("Menor")

                    </code></pre>
                <p style="margin-top:3rem;">Si queremos usar el resultado como otro tipo de dato, podemos convertirlo
                    explícitamente.</p>
                <pre><code data-line-numbers="2-4,6-9" class="python">
    edad = input("¿Cuántos años tienes? ")
    edad = int(edad)
    print(edad >= 18)     # True o False

    precio = input("¿Cuánto cuesta una barra de pan?")
    precio = float(precio)
    if precio > 1.85:
        print("Caro, si me preguntan")

                    </code></pre>
            </section>

            <section>
                <h3>I/O</h3>
                <p>La idea de pedir input por consola no es solo una curiosidad! <br>Se utiliza en la práctica, por
                    ejemplo para <b>construir menús</b></p>
                <pre><code data-line-numbers="2-5,7-14" class="python">
    menu = "Introduce una opción:\n"
    menu += "\t a. Buscar en la base de datos.\n"
    menu += "\t b. Añadir entrada a la base de datos.\n"
    menu += "\t c. Salir.\n"

    msg = ""
    while (msg != "c"):
        msg = input(menu).lower()

        if msg == "a": buscar()
        elif msg == "b": añadir()
        elif msg == "c": print("¡Adiós!")
        else: print("Opción incorrecta.")

                    </code></pre>
            </section>

            <section>
                <h1>Excepciones</h1>
                <!-- Lo vemos antes que I/O con archivos porque nos será útil -->
            </section>

            <section>
                <h3>Excepciones</h3>
                <p style="text-align: center;">Si durante la ejecución ocurre un error, el programa finalizará
                    abruptamente.</p>
                <p style="text-align: center;">El manejo de excepciones nos permite indicar al programa cómo afrontar un
                    error de manera controlada
                    para que pueda continuar ejecutándose.</p>
                <div style="text-align: left; font-size: 90%;" class="fragment">
                    <p>Los bloques de manejo de excepciones utilizan 4 keywords:</p>
                    <ul style="text-align: left;">
                        <li><span style="font-family:monospace;">try</span>: intenta hacer esto, a ver si no falla
                            $\dots$</li>
                        <li><span style="font-family:monospace;">except</span>: si falla algo dentro del try, haz esto
                            $\dots$</li>
                        <li><span style="font-family:monospace;">else</span>: si todo va bien dentro del try, haz esto
                            $\dots$ </li>
                        <li><span style="font-family:monospace;">finally</span>: pase lo que que pase, haz esto $\dots$
                        </li>
                    </ul>
                    <p>Ni <span class="monospace">except</span>, ni <span class="monospace">else</span> ni
                        <span class="monospace">finally</span> son obligatorios.
                    </p>
                </div>
                <pre class="fragment"><code data-line-numbers="2-14" class="python">
    try:
        # Código que puede producir un error
        pass
    except:
        # Se ejecuta si se produce un error
        # El resto de secuencias de try no se ejecutan
        pass
    else:
        # Se ejecuta después de todo el código de try si no se produce un error
        pass
    finally:
        # Se ejecuta en último lugar, independientemente de si se ha producido un error o no
        pass
                    </code></pre>
            </section>

            <section>
                <h3>Algunos ejemplos</h3>
                <pre><code data-line-numbers="2-14" class="python">
    def dividir(a, b):
        try:
            res = a / b
        except ZeroDivisionError as e:
            print("Error. b no puede ser 0:", e)
        else:
            print(res)
        finally:
            print("Terminado!")

    dividir(3, 0)

    dividir(3, 1)

                    </code></pre>
                <pre><code data-line-numbers="2-11" class="python">
    def dividir(a, b):
        try:
            res = a / b
            print(res)
        except:
            print("Error. b no puede ser 0")

    dividir(3, 0)

    dividir(3, 1)

                    </code></pre>
            </section>

            <section>
                <h3>Excepciones</h3>
                <p><span style="font-family:monospace;">except</span> permite recoger varios tipos de errores.</p>
                <p>También podemos generar nuestras propias excepciones.</p>
                <p>Volveremos a esto (necesitamos el concepto de clase).</p>
                <!-- Varios tipos de errores en una sentencia, orden de los errores-->
            </section>

            <section>
                <h1>I/O por archivo</h1>
            </section>

            <section>
                <h2>Lectura de archivos (input)</h2>
                <!-- Esto será útil en la segunda parte del curso -->
                <p>Función básica: <span class="monospace">open(path, modo)</span></p>
                <pre><code class="python" data-line-numbers>
    # Ruta relativa (i.e. desde el mismo directorio que el script)
    archivo = open("archivo.txt", "r")  

    # Ruta absoluta (i.e. desde el directorio raíz)
    archivo2 = open("C:\\Users\\Xiana\\Desktop\\archivo.txt", "r")

    arch_bin = open("archivo_binario.txt", "rb")

                </code></pre>
            </section>

            <section>
                <h3>Lectura de archivos (input)</h3>
                <p>Hay diferentes formas de leer el contenido:</p>
                <pre><code data-line-numbers="3-6|13-18|24-27|33-38|43-48" class="python" style="max-height: 250px;">

    archivo = open("archivo.txt", "r")
    contenido = archivo.read()     # Todo el contenido como una única cadena
    print(contenido)
    archivo.close()






    archivo2 = open("archivo.txt", "r")
    lineas = archivo2.readlines()
    for linea in lineas:
        print(linea.rstrip())   
        # Sin rstrip(), se introducirían 2 saltos de línea
    archivo2.close()





    archivo3 = open("archivo.txt", "r")
    for linea in archivo3:
        print(linea.rstrip()) 
    archivo3.close()





    archivo4 = open("archivo.txt", "r")
    lineas = archivo4.read().splitlines()
    for linea in archivo4:
        print(linea)
        # No hace falta rstrip()
    archivo4.close()




    archivo5 = open("archivo.txt", "r")
    linea = archivo5.readline()
    while linea:
        print(linea.rstrip())
        linea = archivo5.readline()
    archivo5.close()




                    </code></pre>
                <p class="fragment">Importante: <b>cerrar</b> los ficheros!</p>
                <ul>
                    <li class="fragment">Evita la corrupción de los datos.</li>
                    <li class="fragment">Asegura que los últimos cambios se guarden correctamente.</li>
                    <li class="fragment">Libera memoria RAM que se estaba usando como <i>buffer</i>.</li>
                </ul>
            </section>
            <section>
                <h3>Lectura de archivos (input)</h3>
                <div style="text-align:left; display:flex; gap:2rem;">
                    <div style="flex: 1;">
                        <p>Es preferible abrir archivos usando <span style="font-family:monospace;">with</span>:</p>
                        <ul>
                            <li>Cierra los recursos automáticamente.</li>
                            <li>Maneja los errores</li>
                            <li>Código más limpio y compacto</li>
                        </ul>
                    </div>
                    <div style="flex: 1;">
                        <pre><code data-line-numbers class="python">
    # El archivo se cierra automáticamente,
    # no es necesario incluir archivo.close()
    with open("archivo.txt", "r") as archivo:
        for linea in archivo:
            print(linea.rstrip())

                        </code></pre>
                    </div>
                </div>
                <div class="fragment" style="margin-top:2rem;">
                    <p>La sintaxis de <span style="font-family:monospace;">with</span> es equivalente al siguiente
                        bloque de
                        código:</p>
                    <pre><code class="python" data-line-numbers>
    try:
        archivo = open("archivo.txt", "r")
        try:
            datos = archivo.read()
            print(datos)
        finally:
            archivo.close()

                        </code></pre>
                </div>
            </section>

            <section>
                <h3>Lectura de archivos (input)</h3>
                <p>Por supuesto, pueden seguir occuriendo varios errores al abrir archivos $\dots$</p>
                <pre><code data-line-numbers="2-14" class="python">
    try:
        with open("archivo.txt", "r") as archivo:      # archivo = open("archivo.txt", "r")
            for linea in archivo:
                print(linea.rstrip())
    except FileNotFoundError:
        print("El archivo no existe")
    except IOError as e:
        print(f"Error al acceder al archivo: {e}")
    except:
        print("Error desconocido")

                    </code></pre>
            </section>

            <section>
                <h2>Escritura de archivos (output)</h2>
                <div style="text-align: left;">
                    <p style="font-size: 120%;">La función <span class="monospace">open("archivo.txt",
                            <b>modo</b>)</span> tiene varios modos para abrir ficheros:</p>
                    <ul>
                        <li><b class="monospace">r</b> $\rightarrow$ Read mode. Lee el archivo desde el inicio. Si el
                            archivo no existe, se genera un error.
                        </li>
                        <li><b class="monospace">w</b> $\rightarrow$ Write mode. <b>Borra el contenido</b> del archivo y
                            permite escribir nuevo texto sobre él.
                            Si el archivo no existe, lo crea.</li>
                        <li><b class="monospace">a</b> $\rightarrow$ Append mode. Añade nuevo texto desde el final del
                            archivo. Si el archivo no existe, lo
                            crea.</li>
                        <li><b class="monospace">x</b> $\rightarrow$ Create mode. Crea el archivo y permite escribir en
                            él. Si ya existe, genera un error.</li>
                    </ul>
                    <div style="margin-top:4rem;">
                        <p><b class="monospace">r</b> es la opción por defecto: <span
                                class="monospace">open("fichero.txt", "r")</span> y <span
                                class="monospace"></span>open("fichero.txt")</span> hacen lo mismo.</p>
                        <p>A cada uno de estos modos se le puede añadir <b class="monospace">b</b>, para manejar los
                            archivos en binario, o <b class="monospace">t</b>, para
                            manejarlos como archivos de texto (por defecto).</p>
                        <p>Si queremos leer y escribir a la vez, podemos añadir <b class="monospace">+</b>.</p>
                    </div>
                </div>
            </section>
            <section>
                <h3>Escritura de archivos (output)</h3>
                </p>
                <table cellspacing="0" cellpadding="0"
                    style="width: 110%; border-collapse: collapse; border-style:solid; margin-bottom: 10px; padding-bottom: 10px; border-width: 1px;"
                    class="pure-table pure-table-bordered" id="tablaquellevotreshoras">
                    <thead style="background-color: antiquewhite;">
                        <tr>
                            <th>Modo</th>
                            <th>Uso</th>
                            <th>Posición del cursor</th>
                            <th>¿Crea el archivo si no existe?</th>
                            <th>¿Sobreescribe el contenido?</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><b class="monospace">r</b></td>
                            <td>Lectura</td>
                            <td>Inicio</td>
                            <td>No</td>
                            <td>No</td>
                        </tr>
                        <tr>
                            <td><b class="monospace">r+</b></td>
                            <td>Lectura y escritura</td>
                            <td>Inicio</td>
                            <td>No</td>
                            <td>No</td>
                        </tr>
                        <tr>
                            <td><b class="monospace">w</b></td>
                            <td>Escritura</td>
                            <td>Inicio</td>
                            <td>Sí</td>
                            <td>Sí</td>
                        </tr>
                        <tr>
                            <td><b class="monospace">w+</b></td>
                            <td>Lectura y escritura</td>
                            <td>Inicio</td>
                            <td>Sí</td>
                            <td>Sí</td>
                        </tr>
                        <tr>
                            <td><b class="monospace">a</b></td>
                            <td>Escritura (append)</td>
                            <td>Final</td>
                            <td>Sí</td>
                            <td>No</td>
                        </tr>
                        <tr>
                            <td><b class="monospace">a+</b></td>
                            <td>Lectura y escritura (append)</td>
                            <td>Final</td>
                            <td>Sí</td>
                            <td>No</td>
                        </tr>
                    </tbody>
                </table>

            </section>

            <section>
                <h3>Escritura de archivos (output)</h3>
                <div>
                    <img src="media/3/io_modes.png" alt="Diagrama de modos de la funcióno open()">
                </div>
                <em><a href="https://stackoverflow.com/questions/6648493/how-to-open-a-file-for-both-reading-and-writing"
                        target="_blank">Más info</a></em>
            </section>

            <section>
                <h1>Funciones lambda </h1>
                <img src="media/3/lambdas.jpg" alt="Lambdas meme" style="margin-top: 5rem; width:60%;">
            </section>

            <section style="display: flex; flex-direction: column; align-items: left; gap: 2rem;">
                <h3>Funciones lambda</h3>
                <div style="display: flex; justify-content: space-around; flex-wrap: wrap; gap: 2rem;">
                    <div style="flex: 2; text-align: left;">
                        <ul>
                            <li>Son <em>funciones anónimas</em> (i.e. sin nombre) útiles para tareas pequeñas y
                                sencillas.</li>
                            <li>Su origen está en la investigación sobre el concepto de función que dio origen al
                                cálculo lambda de Alonzo Church (1930s).</li>
                            <li>El estilo funcional del cálculo lambda y las funciones lambda busca actuar sin tener en
                                cuenta el estado actual del sistema y evitar los <em>efectos secundarios</em>.</li>
                            <li>Python no es un lenguaje funcional, pero adoptó algunos conceptos de lenguajes
                                funcionales.</li>
                            <li>Las funciones lambda solo pueden tener <em>expresiones puras</em>. No puede haber
                                expresiones con asignaciones $=$, ni bloques <span class="monospace">while</span>, <span
                                    class="monospace">try</span>, etc.</li>
                        </ul>
                    </div>
                    <div style="flex: 2; text-align: left;">
                        <blockquote style="text-align:right; border: 2px solid black; padding: 30px;"
                            cite="https://docs.python.org/3/faq/design.html#why-can-t-lambda-expressions-contain-statements">
                            Unlike lambda forms in other languages, where they add functionality, Python lambdas are
                            only a shorthand notation if you're too lazy to define a function.
                            <br><small style="margin-top: 10px;">Documentación de Python</small>
                        </blockquote>
                    </div>
                </div>

                <aside class="notes">
                    Lambda calculus es Turing completo (cualquier tipo de cálculo, equiv a Máquina de Turing).
                    Los lenguajes funcionales utilizan la filosofía del cálculo lambda.
                    Lenguajes funcionales: Haskell, Lisp, Erlang...
                    Yes, son sintactic sugar.
                </aside>
            </section>

            <section style="display: flex; flex-direction: column; justify-content: space-between;">
                <div style="display: flex; gap: 2rem; align-items: center;">
                    <h2 style="margin: 0;">Sintaxis</h2>
                    <span style="text-align: left; align-items: center;">
                        <span class="monospace" style="align-items: center; position:relative; top:10px;">lambda
                            argumentos: expresión</span>
                    </span>

                </div>
                <div style="display:flex; flex-direction: column; text-align: left;">
                    <ul>
                        <li><span class="monospace">lambda</span> indica que se trata de una función lambda</li>
                        <li><span class="monospace">argumentos</span>: Los parámetros (0, 1 o varios). Estas variables
                            solo pueden ser usadas dentro de la lambda en la que se declaran.</li>
                        <li><span class="monospace">expresión</span>: El cuerpo de la función, que indica qué devuelve.
                            Debe ser una única expresión.</li>
                    </ul>

                    <div style="margin-top: 5rem;">
                        <pre><code class="python" data-line-numbers>
    # Algunos ejemplos de sintaxis
    lambda x: x + 1
    lambda: True

    # Podemos darle un nombre y ejecutarla luego
    cuadrado = lambda x: x * x
    print(cuadrado(3))     # 9

                        </code></pre>
                    </div>
                </div>
            </section>

            <section>
                <h3>Más ejemplos</h3>
                <div style="display: flex; flex-direction: column; gap: 2rem;">
                    <div style="display: flex; gap: 1rem; align-items: center;" class="fragment">
                        <div>
                            <p>Función normal de división</p>
                            <pre style="width: 900px;"><code class="python" data-line-numbers>
    def dividir(x, y):
        if y != 0:
            return x / y
        else:
            return "undefined"
                            </code></pre>
                        </div>
                        <p style="font-size: 120%; width:300px;">
                            $\Longrightarrow$
                        </p>
                        <div>
                            <p>Lambda de división</p>
                            <pre style="width: 900px;"><code class="python" data-line-numbers>
    lambda x, y: x / y if y != 0 else "undefined"



    
                            </code></pre>
                        </div>
                    </div>
                    <div style="display: flex; gap: 1rem; align-items: center;" class="fragment">
                        <div>
                            <p>Función de formato de nombre</p>
                            <pre style="width: 900px;"><code class="python" data-line-numbers>
def nombre_completo(nombre, apellido):
    return f"{nombre.title()} {apellidos.title()}"

                            </code></pre>
                        </div>
                        <p style="font-size: 120%; width:300px;">
                            $\Longrightarrow$
                        </p>
                        <div>
                            <p>Lambda de formato de nombre</p>
                            <pre style="width: 900px;"><code class="python"  data-line-numbers>
lambda nombre, apellido: f"{nombre.title()} {apellidos.title()}"    
                    

                            </code></pre>
                        </div>
                    </div>
            </section>


            <!-- TEXTO ARRIBA, CÓDIGO ABAJO, CON IMAGEN -->
            <section style="display: flex; flex-direction: column; justify-content: space-between;">
                <div style="display: flex; gap: 2rem; align-items: flex-start;">
                    <h2>Casos de uso columnes</h2>
                    <span style="text-align: left;">
                        Las funciones lambda son especialmente útiles cuando se usan junto a <em>iterables</em> y
                        funciones como <span class="monospace">filter</span>, <span class="monospace">map</span>, <span
                            class="monospace">sorted</span>, etc.
                    </span>
                </div>
                <div class="r-stack" style="margin-top:4rem;">
                    <div class="fragment current-visible">
                        <span><span class="monospace">map(<b>func</b>, iter)</span> aplica una función a cada elemento
                            de un iterable.

                            <div style="display: flex; gap: 2rem; flex-direction: row; align-items: center;">
                                <div>
                                    <p>Función + <span class="monospace">map</span></p>
                                    <pre style="width:600px;"><code class="python" data-line-numbers>
    def doblar(x):
        return 2 * x
    
    lista = [1, 2, 3, 4]
    dobles = map(dobles, lista)
    print(dobles)      # [2, 4, 6, 8]
                                </code></pre>
                                </div>
                                <p style="font-size: 120%;">$\Longrightarrow$</p>
                                <div style="flex: 1;">
                                    <p>Lambda + <span class="monospace">map</span> (más conciso)</p>
                                    <pre style="width:900px;"><code class="python" data-line-numbers>
    lista = [1, 2, 3, 4]
    dobles = list(map(lambda x: 2 * x, lista))
    print(dobles)      # [2, 4, 6, 8]


    
                                </code></pre>
                                </div>
                            </div>
                    </div>
                    <div class="fragment current-visible">
                        <span><span class="monospace">filter(<b>func</b>, iter)</span> mantiene solo aquellos elementos
                            del iterable que cumplen <span class="monospace">func(elem)=True</span>.
                            <div style="display: flex; gap: 2rem; flex-direction: row; align-items: center;">
                                <div style="flex: 1;">
                                    <p>Función + <span class="monospace">filter</span></p>
                                    <pre style="width:600px;"><code class="python" data-line-numbers>
    def es_par(x):
        return x % 2 == 0

    lista = range(2, 7)
    res = list(filter(es_par, lista))
    print(res)      # [2, 4, 6]
                            </code></pre>
                                </div>
                                <p style="font-size: 120%;">$\Longrightarrow$</p>
                                <div style="flex: 1;">
                                    <p>Lambda + <span class="monospace">filter</span> (más conciso)</p>
                                    <pre style="width:900px;"><code class="python" data-line-numbers>
    lista = range(2, 7)
    res = list(filter(lambda x: x % 2 == 0, lista))
    print(res)      # [2, 4, 6]



                            </code></pre>
                                </div>
                            </div>
                    </div>
                    <div class="fragment">
                        <span><span class="monospace">sorted(iter, <b>key</b>, reverse)</span> devuelve una lista
                            ordenada a partir de un iterable.
                            <div style="display: flex; gap: 2rem; flex-direction: row; align-items: center;">
                                <div style="flex: 1;">
                                    <pre style="width:800px;"><code class="python" data-line-numbers>
    lista = list('vwerfa')
    ordenada = sorted(lista)
    print(ordenada) 
    # >>> ['a', 'e', 'f', 'r', 'v', 'w']

    # Ordenar números con una función especial (key)
    nums = [15, 11, 4, -5, 0, -1, 9]
    def dist_10(n):
        return abs(10-n)
    print(sorted(nums, key=dist_10))
    # >>> [11, 9, 15, 4, 0, -1, -5]
                                </code></pre>
                                </div>
                                <p style="font-size: 120%;">$\Longrightarrow$</p>
                                <div style="flex: 1;">
                                    <pre style="width:900px;"><code class="python" data-line-numbers>
    # Ordenamos los números igual, pero ahora la key es un lambda
    nums = [15, 11, 4, -5, 0, -1, 9]
    print(sorted(nums, key=lambda n: abs(10-n), reverse=True)) 
    # >>> [-5, -1, 0, 4, 15, 11, 9]






                            </code></pre>
                                </div>
                            </div>
                    </div>
                </div>
                <aside class="notes">
                    filter y map devuelven un iterator
                    en el ejemplo de filter se ve que se puede hacer sobre un iterable cualquiera (range en vez de list)
                    Por defecto, en sorted, key = None, reverse = False (ascending).
                    Nos falta ver reduce() - próximamente
                </aside>
            </section>

            <section>
                <h3>(Aún) más ejemplos</h3>
                <div style="display: flex; gap: 6rem; flex-direction: row; align-items: center; margin-top: 5rem;">
                    <div style="text-align: left;" class="fragment">
                        <ul>
                            <li>Filtrar elementos $> 20$</li>
                        </ul>
                        <pre style="width: 800px;"><code class="python" data-line-numbers>
    datos = range(5, 50, 5)
    mayores_20 = filter(lambda x: x > 20, datos)
    print(list(mayores_20)) # [25, 30, 35, 40, 45]

                        </code></pre>
                    </div>

                    <div style="text-align: left;" class="fragment">
                        <ul>
                            <li>Ordenar una lista de tuplas por el segundo elemento</li>
                        </ul>
                        <pre style="width: 900px;"><code class="python" data-line-numbers>
    datos = [(4, 20), (1, 30), (2, 10)]
    datos_ordenados = sorted(data, key=lambda x: x[1])
    print(datos_ordenados)  # [(2, 10), (3, 20), (1, 30)]

                        </code></pre>
                    </div>
                </div>
                <div style="display: flex; gap: 6rem; flex-direction: row; align-items: center; margin-top: 5rem;">
                    <div style="text-align: left;" class="fragment">
                        <ul>
                            <li><code>reduce()</code> aplica una función iterativamente a todos los elementos de un
                                iterable, operando sobre los
                                sucesivos resultados parciales, y devuelve un único valor.</li>
                        </ul>
                        <pre style="width: 800px;"><code class="python" data-line-numbers>
    from functools import reduce
    
    reduce(function, iterable[, initializer])






                        </code></pre>
                    </div>

                    <div style="text-align: left;" class="fragment">
                        <ul>
                            <li><code>reduce()</code> se suele usar para agregar todos los elementos de un iterable, por
                                ejemplo, sumándolos.</li>
                        </ul>
                        <pre style="width: 900px;"><code class="python" data-line-numbers>
    def custom_sumar(a, b):
        res = a + b
        print(f"{a} + {b} = {res}")
        return res

    nums = [1, 2, 3, 4]
    reduce(custom_sumar, nums)
    # 1 + 2 = 3
    # 3 + 3 = 6
    # 6 + 4 = 10

                        </code></pre>
                    </div>
                </div>
            </section>

            <section>
                <h3>Funciones lambda</h3>
                <div
                    style="display: flex; align-items: stretch; min-height: 250px; font-family: Arial, sans-serif; margin-top: 5rem;">
                    <div style="width: 45%; padding: 20px; text-align: left;">
                        <h3 style="margin-top: 0;">✅ Ventajas</h3>
                        <ul style="padding-left: 20px;">
                            <li>Concisas, compactas</li>
                            <li>Útiles en casos sencillos</li>
                            <li>Pueden ser combinadas con conceptos de lenguaje funcional (map, filter, etc.)</li>
                            <li>No tienen nombre ⟹ menos variables, código más limpio</li>
                        </ul>
                    </div>

                    <div style="width: 2px; background-color: black; margin: 20px 10px;"></div>

                    <div style="width: 45%; padding: 20px; text-align: left;">
                        <h3 style="margin-top: 0;">❌ Desventajas</h3>
                        <ul style="padding-left: 20px;">
                            <li>No pueden ser reutilizadas (a menos que se asignen a una variable...)</li>
                            <li>Pueden reducir la legibilidad y ser sobreusadas</li>
                            <li>En caso de error, es más difícil seguir el stack trace</li>
                            <li>Peor documentación, no se pueden manejar excepciones con <span
                                    style="font-family: monospace;">try</span></li>
                        </ul>
                    </div>
                </div>

                <aside class="notes">
                    Lo de asignar una lambda a una variable está desaconsejado según PEP (guía de estilo)
                    Lo del stacktrace es porque todas las funciones lambda se llaman igual: "lambda"
                    Las lambdas no tienen docstrings
                </aside>
            </section>

            <section>
                <h1>Python Object Oriented Programming<br>aka<br>Python OOP<br>aka<br>POOP 💩</h1>
            </section>


            <section style="display: flex; flex-direction: column; justify-content: space-between;">
                <div style="display: flex; gap: 2rem; align-items: flex-start;">
                    <h2>Programación Orientada a Objetos: una breve introducción</h2>
                    <span style="text-align: left;">
                        Es un <b>paradigma de programación</b> basado en el concepto de <b>objetos</b>.
                    </span>

                </div>
                <div style="display:flex; flex-direction: column; text-align: left;">
                    <ul>
                        <li>Un <b>objeto</b> tiene un <b>estado</b> y un <b>comportamiento</b>.</li>
                        <li class="fragment"><b>Estado</b>: atributos = propiedades -> variables que almacenan datos de
                            un objeto.</li>
                        <li class="fragment"><b>Comportamiento</b>: métodos = funciones -> definen qué puede hacer el
                            objeto.</li>
                        <li class="fragment">Los objetos se abstraen en forma de <b>clases</b>. Un objeto es una
                            <b>instancia</b> de una
                            clase.
                        </li>
                    </ul>

                    <div
                        style="display: flex; flex-direction: row; align-items: flex-start; margin-top: 2rem; gap:2rem; justify-content: space-between;">
                        <img src="media/3/clase_person.png" width="700px">
                        <img src="media/3/clase_perro.jpg" width="700px">
                    </div>
                </div>
                <aside class="notes">
                    Una clase es una plantilla de cómo construir un objeto.
                </aside>
            </section>

            <section>
                <div style="display: flex; gap: 4rem;">
                    <div style="flex: 1; display: flex; flex-direction: column; justify-content: space-around;">
                        <div style="text-align: left;">
                            <h5 style="margin-top:2rem;">Python OOP</h5>
                            <p>Veamos cómo implementar el ejemplo de la imagen</p>
                            <ol style="font-size: 80%;">
                                <li>Primero necesitamos crear la clase con <span class="monospace">class Person</span> y
                                    añadir su <em>constructor</em>, esto es, el método que se encarga de crear los
                                    objetos: <span class="monospace">__init__(self)</span></li>
                                <li class="fragment" data-fragment-index="1">Ahora añadimos los atributos de cada
                                    persona, su nombre, edad, género y ocupación. Pasamos estos datos al constructor,
                                    que los guardará usando <span class="monospace">self.&ltatributo&gt</atributo>
                                    </span></li>
                                <li class="fragment" data-fragment-index="2">Los <b>métodos</b> son funciones dentro
                                    de la clase que modifican al objeto. Su
                                    primer argumento tiene que ser <span class="monospace">self</span>, que representa
                                    el propio objeto.</li>
                                <li class="fragment" data-fragment-index="3">Para este ejemplo, añadimos también un
                                    atributo
                                    adicional de salud que tiene cada persona, <span class="monospace">health</span>. Lo
                                    inicializamos a $100$ en el constructor y modificamos en cada llamada a los métodos.
                                </li>

                            </ol>
                        </div>
                        <div style="display: flex;">
                            <img src="media/3/clase_person.png" width="600px">
                        </div>
                    </div>

                    <div style="flex: 1;" class="r-stack">
                        <pre style="height: 800px;">
                            <code class="python" data-line-numbers>
    class Person:
        def __init__(self):
            pass
    












    


    









                            </code></pre>
                        <pre style="height: 800px;" class="fragment" data-fragment-index="1">
                                <code class="python" data-line-numbers>
    class Person:
        def __init__(self, name, age, gender, occupation):
            self.name = name
            self.age = age
            self.gender = gender
            self.occupation = occupation
    
    # Ya podemos crear objetos de la clase Persona
    marta = Person("Marta", 20, "F", "estudiante")
    artai = Person("Artai", 23, "NB", "dibujante")












    






                                </code></pre>
                        <pre style="height: 800px;" class="fragment" data-fragment-index="2">
                                    <code class="python" data-line-numbers>
    class Person:
        def __init__(self, name, age, gender, occupation):
            self.name = name
            self.age = age
            self.gender = gender
            self.occupation = occupation

        def walk(self):
            print(f"{self.name} está caminando")
        
        def eat(self, comida):
            print(f"{self.name} está comiendo {comida}")
            
        def sleep(self):
            print("No hace nada...")
        
        def work():
            print("Qué currante")

    marta = Person("Marta", 20, "F", "estudiante")
    artai = Person("Artai", 23, "NB", "dibujante")





            

    
                                    </code></pre>
                        <pre style="height: 800px;" class="fragment" data-fragment-index="3">
                                        <code class="python" data-line-numbers>
    class Person:
        def __init__(self, name, age, gender, occupation):
            self.name = name
            self.age = age
            self.gender = gender
            self.occupation = occupation
            self.health = 100 # Salud inicial
    
        def walk(self):
            print(f"{self.name} está caminando")
            self.health += 5 # Caminar es bueno para la salud
        
        def eat(self, comida):
            print(f"{self.name} está comiendo {comida}")
            self.health += 10 # Recuperamos fuerzas
            
        def sleep(self):
            print("No hace nada...")
            self.health += 20 # A mimir zzzzz
        
        def work():
            print("Qué currante")
            self.health -= 10 # El trabajo es duro
    
    marta = Person("Marta", 20, "F", "estudiante")
    artai = Person("Artai", 23, "NB", "dibujante")
    


                                        </code></pre>

                    </div>

                </div>
                <aside class="notes">
                    Mencionar lo de que los atributos se suelen denominar igual que los argumentos, pero que son
                    distintos.
                </aside>
            </section>
            <section>
                <h3>Métodos</h3>
                <div>
                    <p>Ahora podemos llamar a los métodos de cada objeto creados con la sintaxis <span
                            class="monospace">objeto.metodo(args...)</span></p>
                    <p>Con esto, ejecutamos una <em>acción</em> sobre el objeto, posiblemente alterando su estado.</p>
                    <p><b>Importante:</b> Cuando llamamos a un método de un objeto, no hace falta pasar <span
                            class="monospace">self</span></p>
                </div>
                <pre><code class="python" data-line-numbers>
    marta = Person("Marta", 20, "F", "estudiante")
    artai = Person("Artai", 23, "NB", "dibujante")

    marta.walk()         # Marta está caminando	
    marta.eat("pizza")   # Marta está comiendo pizza

    # Podemos también acceder e imprimir los valores del objeto
    print(marta.name)   # Marta
    print(marta.health) # 115
    marta.work()        # Qué currante
    print(marta.health) # 105

                </code></pre>
            </section>
            <section>
                <h3>Herencia</h3>
                <div>
                    <ul>
                        <li>La herencia es un mecanismo que contienen todos los lenguajes orientados a objetos en los
                            que una clase, la subclase, <em>"expande"</em> a otra, la superclase.</li>
                        <li>Las subclases se caracterizan por ser un tipo particular de la superclase (''is a'').</li>
                        <li>Por ejemplo, un doctor es un tipo particular de persona. Por tanto, podríamos tener
                            una clase <span class="monospace">Doctor</span> que expandiera
                            a <span class="monospace">Person</span></li>
                        <li>Podemos llamar a los elementos de la <em>superclase</em> con <span
                                class="monospace">super().&ltmetodo&gt()</span></li>
                        <li>En el constructor de la subclase, podemos llamar o no al constructor de la superclase (pero
                            es buena práctica hacerlo).</li>
                    </ul>
                    <pre><code class="python" data-line-numbers>
    class Doctor(Person):
        def __init__(self, name, age, gender, specialty):
            # Buena práctica: El constructor original de Person cubre campos comúnes
            super().__init__(name, age, "M", "doctor")
            # Ahora añadimos el resto del estado inicial
            self.specialty = specialty

                    </code></pre>
                </div>
                <div class="fragment" data-fragment-index="1">
                    <p>Los objetos de subclase pueden acceder y llamar a los métodos de su <em>clase base</em>.
                        <br>Por ejemplo, un nuevo Doctor podría llamar a <span class="monospace">walk()</span>
                    </p>
                    <pre><code class="python" data-line-numbers>
    doc = Doctor("House", 45, "M", "médico de cabecera")
    doc.walk() # House está caminando

                    </code></pre>
                </div>
                <small class="fragment" data-fragment-index="1"><b>Nota obligatoria:</b> en la mayoría de los casos, <a
                        href="https://python-patterns.guide/gang-of-four/composition-over-inheritance/">suele ser mejor
                        idea usar composición en vez de herencia!</a></small>
            </section>
            <section>
                <h3>Herencia: overriding</h3>
                <div>
                    <p>Una subclase puede reimplementar un método que ya está en la superclase. Esto se conoce como
                        <em>overriding</em> (o sobreescritura)
                    </p>
                    <p>Por ejemplo, si queremos que un Doctor camine de forma diferente a una Persona normal, podemos
                        hacerlo así:</p>
                    <pre><code class="python" data-line-numbers>
    class Doctor(Person):
        def walk(self):
            print(f"{self.name} está caminando... pero con bata")
                    </code></pre>
                    <p class="fragment"><b>Más avanzado:</b> Esto lleva al concepto de polimorfismo. Las clases que
                        sobreescriben métodos se pueden comportar como instancias de su superclase, hasta que llaman a
                        uno de los métodos sobreescritos. Entonces, se ejecuta la versión sobreescrita en vez de la
                        original $\dots$</p>
                </div>
            </section>
            <section>
                <h4>Un ejemplo práctico: clases de excepciones personalizadas</h4>
                <div>
                    <ul>
                        <li>Python permite crear excepciones personalizadas heredando de la clase <span
                                class="monospace">Exception</span> o sus subclases</li>
                        <li>Las excepciones personalizadas mejoran la legibilidad y mantenibilidad del código</li>
                        <li>Son útiles para manejar errores específicos de nuestra aplicación</li>
                    </ul>
                    <pre><code class="python" data-line-numbers>
    class UXAError(Exception):
        def __init__(self, message = "Tu matrícula es incorrecta"):
            super().__init__(message)

                    </code></pre>
                </div>
                <div class="fragment">
                    <p>Uso de la excepción personalizada en código:</p>
                    <pre><code class="python" data-line-numbers>
    def matricularse_usc(str_matricula):
        if str_matricula == "No quiero estudiar":
            raise UXAError()
        return str_matricula + " aceptada"
    
    try:
        resultado = matricularse_usc("No quiero estudiar")
    except UXAErrror as error:
        print(f"Error al matricularse en la USC: {error}")
    
                    </code></pre>
                </div>
                <aside class="notes">
                    Si no se usa una subclase de Exception, no se pueden usar features como raise y except.
                    Usando el concepto de polimorfismo, se pueden recoger excepciones concretas con superclases más
                    generales.
                </aside>
            </section>
            <section>
                <h4>Más sobre Python OOP</h4>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); font-size: 80%;">
                    <div class="fragment">
                        <p>Podemos implementar el método <span class="monospace">__str__(self)</span> para modificar
                            como se imprime un objeto de una clase</p>
                        <pre><code class="python" data-line-numbers>
    class Person:
        def __str__(self):
            return f"{self.name} es un {self.occupation} de {self.age}"
                        f"años y género {self.gender}"
    
    # Ahora podemos imprimir más fácilmente un objeto Person
    marta = Person("Marta", 20, "F", "estudiante")
    print(marta) # Marta es un estudiante de 20 años y género F
    
                        </code></pre>
                    </div>
                    <div class="fragment">
                        <p>Hay muchos más <em>métodos mágicos</em> de este estilo, por ejemplo <span
                                class="monospace">__em__</span> para reimplementar la igualdad entre dos objetos de la
                            misma clase, <span class="monospace">__add__</span> para la suma, $\dots$</p>
                        <pre><code class="python" data-line-numbers>
    class Vector:
        def __init__(self, x, y):
            self.x = x
            self.y = y
        def __add__(self, other):
            return Vector(self.x + other.x, self.y + other.y)
        def __str__(self):
            return f"({self.x}, {self.y})"
    v1 = Vector(1, 2)
    v2 = Vector(3, 4)
    print(v1 + v2) # (4, 6)
                        </code></pre>
                    </div>
                    <div class="fragment">
                        <p>La clase <span class="monospace">object</span> es la clase base de todas las demás, aunque no
                            se especifique explícitamente. Los tipos y contenedores primitivos (int, str, list, dict,
                            $\dots$) también son subclases de <span class="monospace">object</span></p>
                    </div>
                    <div class="fragment">
                        <p><b>Más avanzado:</b> Gracias a que todos los objetos sean subclases de object, funcionan los
                            métodos mágicos! Todos estos métodos están definidos en object, y no hacemos más que
                            overridearlos. El lenguaje interpreta cada uno de ellos de forma especial, y los asigna a
                            los operadores. Por ejemplo <span class="monospace">v1 + v2</span> es lo mismo que <span
                                class="monospace">v1.__add__(v2)</span></p>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <script src="dist/reveal.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/markdown/markdown.js"></script>
    <script src="plugin/highlight/highlight.js"></script>
    <script src="plugin/math/math.js"></script>
    <script>
        // More info about initialization & config:
        // - https://revealjs.com/initialization/
        // - https://revealjs.com/config/
        Reveal.initialize({
            hash: true,
            katex: {
                version: 'latest',
                delimiters: [
                    { left: '$$', right: '$$', display: true },
                    { left: '$', right: '$', display: false },
                    { left: '\\(', right: '\\)', display: false },
                    { left: '\\[', right: '\\]', display: true },
                ],
                ignoredTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            },
            // Learn about plugins: https://revealjs.com/plugins/
            plugins: [RevealMarkdown, RevealHighlight, RevealNotes, RevealMath.KaTeX]
        });

    </script>
    <script src="theme-toggle.js"></script>
</body>

</html>