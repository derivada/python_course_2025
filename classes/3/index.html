<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="../../dist/reset.css">
		<link rel="stylesheet" href="../../dist/reveal.css">
		<link rel="stylesheet" href="../../dist/theme/solarized.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="../../plugin/highlight/monokai.css">
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<!-- Each section corresponds to a slide -->
                <section>
                    <h1>3. I/O, lambdas y programación con OOP</h1>
                </section>

                <section>
                    <p>Ya hemos visto cómo imprimir datos por consola:</p>
                    <pre><code data-line-numbers="2-6" class="python">
                        print("Damn")
                        x = 4
                        print(f"2+2 = {x}")
                    </code></pre>

                    <p>Veamos el proceso inverso: la introducción de datos por consola.</p>
                </section>

                <section>
                    <p>Podemos pedir al usuario que introduzca datos:</p>
                    <pre><code data-line-numbers="2-6" class="python">
                        mensaje_del_usuario = input("Dime tu nombre: ")
                        print(mensaje_del_usuario)
                    </code></pre>
                    <!-- "Dime tu nombre: " es la prompt -->
                    <!-- Lo que el usuario introduce se guarda en la variable mensaje_del_usuario -->
                    <!-- Es recomendable dejar un espacio después de : para mejor legibilidad --> 
                    <p>Si el prompt es largo, es recomendable escribirlo por separado de antemano:</p>
                    <pre><code data-line-numbers="2-6" class="python">
                        prompt = "Buenos días! Este es el servicio de atención al usuario.\n"
                        prompt += "Por favor, escribe tu nombre: "

                        nombre = input(prompt)
                        print(f"Hola, {nombre}.")
                    </code></pre>
                </section>

                <section>
                    <p>Por defecto, input() devuelve strings.</p>
                    <pre><code data-line-numbers="2-6" class="python">
                        edad = input("¿Cuántos años tienes? ")
                        if edad >= 18:       # TypeError: '>=' not supported between instances of 'str' and 'int'
                            print("Adulto")
                        else:
                            print("Menor")

                    </code></pre>
                    <p>Si queremos usar el resultado como otro tipo de dato, podemos convertirlo explícitamente.</p>
                    <pre><code data-line-numbers="2-4,6-9" class="python">
                        edad = input("¿Cuántos años tienes? ")
                        edad = int(edad)
                        print(edad >= 18)     # True o False

                        precio = input("¿Cuánto cuesta una barra de pan?")
                        precio = float(precio)
                        if precio > 1.85:
                            print("Caro, si me preguntan")

                    </code></pre>
                </section>

                <section>
                    <p>La idea de pedir input no es solo una curiosidad. Se utiliza en la práctica, por ejemplo para construir menús</p>
                    <pre><code data-line-numbers="2-5,7-14" class="python">
                        menu = "Introduce una opción:\n"
                        menu += "\t a. Buscar en la base de datos.\n"
                        menu += "\t b. Añadir entrada a la base de datos.\n"
                        menu += "\t c. Salir.\n"
                        
                        msg = ""
                        while (msg != "c"):
                            msg = input(menu).lower()
                        
                            if msg == "a": buscar()
                            elif msg == "b": añadir()
                            elif msg == "c": print("¡Adiós!")
                            else: print("Opción incorrecta.")

                    </code></pre>
                </section>

                <section>
                    <h1>Excepciones</h1>
                    <!-- Lo vemos antes que I/O con archivos porque nos será útil -->
                </section>

                <section>
                    <p>Si durante la ejecución ocurre un error, el programa finalizará abruptamente.</p>
                    <p>El manejo de excepciones nos permite indicar al programa cómo afrontar un error de manera controlada para que pueda continuar ejecutándose.</p>
                    <p>Los bloques de manejo de excepciones utilizan 4 keywords (ninguna obligatoria): <span style="font-family:monospace;">try</span>, <span style="font-family:monospace;">except</span>, <span style="font-family:monospace;">else</span> y <span style="font-family:monospace;">finally</span>.</p>
                    <pre><code data-line-numbers="2-14" class="python">
                        try:
                            # Código que puede producir un error
                            pass
                        except:
                            # Se ejecuta si se produce un error
                            # El resto de secuencias de try no se ejecutan
                            pass
                        else:
                            # Se ejecuta después de todo el código de try si no se produce un error
                            pass
                        finally:
                            # Se ejecuta en último lugar, independientemente de si se ha producido un error o no
                            pass
                    </code></pre>
                    Nota: el orden es importante. try-else-except no es válido.
                    Quitar los pass y preguntar por qué el código daría un error?
                    else es útil para lo que dependa de que el bloque de try tenga éxito
                    else y finally son anecdóticos
                    Puede haber else sin except, finally sin ... pero todos dependen de try
                </section>

                <section>
                    <pre><code data-line-numbers="2-14" class="python">
                        def dividir(a, b):
                            try:
                                res = a / b
                            except ZeroDivisionError as e:
                                print("Error. b no puede ser 0:", e)
                            else:
                                print(res)
                            finally:
                                print("Terminado!")

                        dividir(3, 0)

                        dividir(3, 1)

                    </code></pre>
                    <pre><code data-line-numbers="2-11" class="python">
                        def dividir(a, b):
                            try:
                                res = a / b
                                print(res)
                            except:
                                print("Error. b no puede ser 0")

                        dividir(3, 0)

                        dividir(3, 1)

                    </code></pre>
                </section>

                <section>
                    <p><span style="font-family:monospace;">except</span> permite recoger varios tipos de errores en una sola sentencia:</p>
                </section>

                <section>
                    except puede recoger varios tipos de errores... prioridades...
                </section>

                <section>
                    <p>También podemos generar nuestras propias excepciones.</p>

                </section>

                <section>
                    I/O por archivo
                </section>

                <section>
                    <h2>Lectura de archivos</h2>
                    <!-- Esto será útil en la segunda parte del curso -->
                    <p>Función básica: open()</p>
                    <pre><code>
                        archivo = open("archivo.txt", "r")    # Ruta relativa
                        archivo2 = open("C:\\Users\\Xiana\\Desktop\\archivo.txt", "r")    # Ruta absoluta (estilo Windows, \ escapado)
                    
                        bin = open("archivo_binario.txt", "rb")
                    </code></pre>
                </section>

                <section>
                    <p>Hay diferentes formas de leer el contenido:</p>
                    <pre><code data-line-numbers="3-6|13-18|24-27|33-38|43-48" class="python" style="max-height: 250px;">
                        
                        archivo = open("archivo.txt", "r")
                        contenido = archivo.read()     # Todo el contenido como una única cadena
                        print(contenido)
                        archivo.close()






                        archivo2 = open("archivo.txt", "r")
                        lineas = archivo2.readlines()
                        for linea in lineas:
                            print(linea.rstrip())   
                            # Sin rstrip(), se introducirían 2 saltos de línea
                        archivo2.close()




                        
                        archivo3 = open("archivo.txt", "r")
                        for linea in archivo3:
                            print(linea.rstrip()) 
                        archivo3.close()
                        



                        
                        archivo4 = open("archivo.txt", "r")
                        lineas = archivo4.read().splitlines()
                        for linea in archivo4:
                            print(linea)
                            # No hace falta rstrip()
                        archivo4.close()




                        archivo5 = open("archivo.txt", "r")
                        linea = archivo5.readline()
                        while linea:
                            print(linea.rstrip())
                            linea = archivo5.readline()
                        archivo5.close()




                    </code></pre>
                    TODO: meter tabla resumen
                </section>
                <section>
                    <p>Es preferible abrir archivos usando <span style="font-family:monospace;">with</span>:</p>
                    <ul>
                        <li>Cierra los recursos automáticamente.</li>
                        <li>Maneja los errores</li>
                        <li>Código más limpio y compacto</li>
                    </ul>
                    <pre><code data-line-numbers="2-7" class="python">
                        with open("archivo.txt", "r") as archivo:      # archivo = open("archivo.txt", "r")
                            for linea in archivo:
                                print(linea.rstrip())

                        # archivo se cierra automáticamente, sin necesidad de llamar explícitamente a archivo.close()
                        # No es necesario incluir archivo.close()


                    </code></pre>
                    <p>La sintaxis de <span style="font-family:monospace;">with</span> es equivalente al siguiente bloque de código:</p>
                    <pre><code data-line-numbers="2-14" class="python">
                        try:
                            archivo = open("archivo.txt", "r")
                            try:
                                datos = archivo.read()
                                print(datos)
                            finally:
                                archivo.close()

                    </code></pre>
                    TODO: with para input y output a la vez
                    Nota: no es necesario hacer close en el bloque externo porque el archivo no se ha llegado a abrir (de hecho, daría un error)
                </section>

                <section>
                    <pre><code data-line-numbers="2-14" class="python">
                        try:
                            with open("archivo.txt", "r") as archivo:      # archivo = open("archivo.txt", "r")
                                for linea in archivo:
                                    print(linea.rstrip())
                        except FileNotFoundError:
                            print("El archivo no existe")
                        except IOError as e:
                            print(f"Error al acceder al archivo: {e}")
                        except:
                            print("Error desconocido")

                    </code></pre>
                </section>
			</div>
		</div>

		<script src="../../dist/reveal.js"></script>
		<script src="../../plugin/notes/notes.js"></script>
		<script src="../../plugin/markdown/markdown.js"></script>
		<script src="../../plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});
		</script>
	</body>
</html>